import{b as ut,_ as Ce,r as n,u as $e,e as Be,f as Q,g as Ve,o as Ue,h as g,i as M,j as We,w as p,M as qe,k as xt,l as k,m as t,n as O,p as r,q as y,t as o,F as Z,s as tt,v as ie,x as Pe,y as ce,E as At,z as He,A as Ge}from"./index-BARRCFgq.js";var re={exports:{}};(function(G,et){(function(z,i){i()})(ut,function(){function z(u,m){return typeof m>"u"?m={autoBom:!1}:typeof m!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),m={autoBom:!m}),m.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(u.type)?new Blob(["\uFEFF",u],{type:u.type}):u}function i(u,m,S){var f=new XMLHttpRequest;f.open("GET",u),f.responseType="blob",f.onload=function(){C(f.response,m,S)},f.onerror=function(){console.error("could not download file")},f.send()}function st(u){var m=new XMLHttpRequest;m.open("HEAD",u,!1);try{m.send()}catch{}return 200<=m.status&&299>=m.status}function V(u){try{u.dispatchEvent(new MouseEvent("click"))}catch{var m=document.createEvent("MouseEvents");m.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),u.dispatchEvent(m)}}var b=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof ut=="object"&&ut.global===ut?ut:void 0,_t=b.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),C=b.saveAs||(typeof window!="object"||window!==b?function(){}:"download"in HTMLAnchorElement.prototype&&!_t?function(u,m,S){var f=b.URL||b.webkitURL,w=document.createElement("a");m=m||u.name||"download",w.download=m,w.rel="noopener",typeof u=="string"?(w.href=u,w.origin===location.origin?V(w):st(w.href)?i(u,m,S):V(w,w.target="_blank")):(w.href=f.createObjectURL(u),setTimeout(function(){f.revokeObjectURL(w.href)},4e4),setTimeout(function(){V(w)},0))}:"msSaveOrOpenBlob"in navigator?function(u,m,S){if(m=m||u.name||"download",typeof u!="string")navigator.msSaveOrOpenBlob(z(u,S),m);else if(st(u))i(u,m,S);else{var f=document.createElement("a");f.href=u,f.target="_blank",setTimeout(function(){V(f)})}}:function(u,m,S,f){if(f=f||open("","_blank"),f&&(f.document.title=f.document.body.innerText="downloading..."),typeof u=="string")return i(u,m,S);var w=u.type==="application/octet-stream",mt=/constructor/i.test(b.HTMLElement)||b.safari,ot=/CriOS\/[\d]+/.test(navigator.userAgent);if((ot||w&&mt||_t)&&typeof FileReader<"u"){var q=new FileReader;q.onloadend=function(){var U=q.result;U=ot?U:U.replace(/^data:[^;]*;/,"data:attachment/file;"),f?f.location.href=U:location=U,f=null},q.readAsDataURL(u)}else{var F=b.URL||b.webkitURL,P=F.createObjectURL(u);f?f.location=P:location.href=P,f=null,setTimeout(function(){F.revokeObjectURL(P)},4e4)}});b.saveAs=C.saveAs=C,G.exports=C})})(re);var ze=re.exports;const s=G=>(He("data-v-03ca651f"),G=G(),Ge(),G),Fe={class:"p-2"},Ke=s(()=>t("h2",{class:"text-xl font-bold mt-2 ml-6"},"Statement Analysis Result",-1)),Je={key:0,class:"flex items-center justify-center h-96"},Xe={key:1,class:"p-2 md:p-8"},Qe={class:"flex justify-between"},Ze=s(()=>t("i",{class:"fas fa-arrow-left mr-2"},null,-1)),ts={class:"text-right"},es=s(()=>t("i",{class:"fas fa-download mr-2"},null,-1)),ss={class:"grid grid-cols-1 md:grid-cols-3 gap-6 text-gray-700 mt-4 mb-6"},os=s(()=>t("i",{class:"fas fa-calendar mr-2"},null,-1)),ns=s(()=>t("strong",null,"Statement Period:",-1)),as=s(()=>t("br",null,null,-1)),ls=s(()=>t("i",{class:"fas fa-user-circle mr-2"},null,-1)),ds=s(()=>t("strong",null,"Account Name:",-1)),is=s(()=>t("br",null,null,-1)),cs=s(()=>t("i",{class:"fas fa-id-card mr-2"},null,-1)),rs=s(()=>t("strong",null,"Account Number:",-1)),us=s(()=>t("br",null,null,-1)),_s={class:"mt-6"},ms={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 px-4"},fs={class:"bg-blue-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},ps={class:"text-md font-semibold"},hs=s(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Total Credit",-1)),vs={class:"bg-red-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},ys={class:"text-md font-semibold"},xs=s(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Total Debits",-1)),bs={class:"bg-green-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},gs={class:"text-md font-semibold"},ws=s(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Avg. Monthly Credit",-1)),Ms={class:"bg-purple-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},Ts={class:"text-md font-semibold"},As=s(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Avg. Monthly Debits",-1)),ks={class:"bg-gray-100 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},Os={class:"text-md font-semibold"},Ys=s(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Average Monthly Balance",-1)),Ss={class:"flex flex-col md:flex-row gap-4 p-4"},Rs={class:"bg-white rounded-2xl shadow-md p-4 w-full md:w-1/3"},Ds=s(()=>t("p",{class:"text-sm text-gray-500 mb-1"},"Most Frequent Expense",-1)),Is={class:"font-semibold text-gray-800 leading-tight"},js=s(()=>t("br",null,null,-1)),Ns={class:"bg-white rounded-2xl shadow-md p-4 w-full md:w-1/3"},Es=s(()=>t("p",{class:"text-sm text-gray-500 mb-1"},"Highest Spend",-1)),Ls={class:"font-semibold text-gray-800 text-lg"},Cs={class:"text-sm font-semibold text-gray-600 mt-1"},$s={class:"bg-white rounded-2xl shadow-md p-4 w-full md:w-1/3"},Bs=s(()=>t("p",{class:"text-sm text-gray-500 mb-1"},"Most Frequent Expense Amount",-1)),Vs={class:"font-semibold text-gray-800 text-lg"},Us={class:"bg-white p-6 rounded-2xl shadow-md overflow-x-auto"},Ws=s(()=>t("h2",{class:"text-lg font-semibold text-gray-800 m-4"},"Expenses",-1)),qs={class:"min-w-full table-auto border-collapse"},Ps=s(()=>t("thead",null,[t("tr",{class:"text-left text-sm font-semibold text-gray-600 border-b border-gray-200"},[t("th",{class:"py-3 px-4"},"Expenses"),t("th",{class:"py-3 px-4"},"Average Monthly Expenditure"),t("th",{class:"py-3 px-4"},"Total Expenditure")])],-1)),Hs={class:"py-3 px-4"},Gs={class:"py-3 px-4"},zs={class:"py-3 px-4"},Fs={class:"flex flex-col md:flex-row gap-4 text-center text-gray-500 py-10"},Ks={class:"flex-1 bg-white border p-6 rounded-xl shadow"},Js=s(()=>t("h2",{class:"text-lg font-semibold text-blue-800 mb-4"},"Inflow Summary",-1)),Xs={class:"space-y-2"},Qs={class:"flex justify-between"},Zs=s(()=>t("span",null,"Total Inflow",-1)),to={class:"text-green-600 font-bold"},eo={class:"flex justify-between"},so=s(()=>t("span",null,"Average Monthly Inflow",-1)),oo={class:"font-medium"},no={class:"flex justify-between"},ao=s(()=>t("span",null,"Average Weekly Inflow",-1)),lo={class:"font-medium"},io={class:"flex-1 bg-white border p-6 rounded-xl shadow"},co=s(()=>t("h2",{class:"text-lg font-semibold text-blue-800 mb-4"},"Outflow Summary",-1)),ro={class:"space-y-2"},uo={class:"flex justify-between"},_o=s(()=>t("span",null,"Total Outflow",-1)),mo={class:"text-red-600 font-bold"},fo={class:"flex justify-between"},po=s(()=>t("span",null,"Average Monthly Outflow",-1)),ho={class:"font-medium"},vo={class:"flex justify-between"},yo=s(()=>t("span",null,"Average Weekly Outflow",-1)),xo={class:"font-medium"},bo={class:"flex gap-4 justify-between p-2"},go={class:"flex justify-between bg-[#1f4e99] text-white rounded-2xl p-6 w-full"},wo={class:"flex-1 text-md font-semibold"},Mo=s(()=>t("div",{class:"text-sm mt-2"},"Average Monthly Balance",-1)),To={class:"flex-1 text- text-md font-semibold"},Ao=s(()=>t("div",{class:"text-sm mt-2"},"Average Weekly Balance",-1)),ko=s(()=>t("div",{class:"flex justify-between bg-[#1f4e99] text-white rounded-2xl p-6 w-full"},[t("div",{class:"flex-1"},[t("div",{class:"text-md font-semibold"},"Negative Cash Flow"),t("div",{class:"text-sm mt-2"},"Inflow to Outflow Rate")]),t("div",{class:"flex-1"},[t("div",{class:"text-md font-semibold"},"Negative Cash Flow"),t("div",{class:"text-sm mt-2"},"Overall Inflow to Outflow")])],-1)),Oo={class:"p-2 rounded-lg shadow-md"},Yo=s(()=>t("h2",{class:"text-lg font-semibold text-gray-800 mb-2 mt-2"}," Credit & Debit Summary ",-1)),So={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ro={class:"bg-white p-4 rounded-lg shadow"},Do=s(()=>t("h3",{class:"text-lg font-bold text-gray-700 mb-3"},"Monthly Credit & Debit",-1)),Io={class:"overflow-y-auto max-h-96"},jo={class:"min-w-full table-auto text-sm text-left text-gray-600"},No=s(()=>t("thead",{class:"bg-gray-100 font-medium text-gray-700"},[t("tr",null,[t("th",{class:"px-2 py-2"},"Month"),t("th",{class:"px-2 py-2"},"Total Credit"),t("th",{class:"px-2 py-2"},"Total Debit")])],-1)),Eo={class:"px-2 py-2"},Lo={class:"px-2 py-2"},Co={class:"px-2 py-2"},$o={class:"font-semibold text-gray-800 bg-gray-50 border-t"},Bo=s(()=>t("td",{class:"px-2 py-2"},"Total",-1)),Vo={class:"px-2 text-green-800 py-2"},Uo={class:"px-2 text-red-800 py-2"},Wo={class:"bg-white p-4 rounded-lg shadow"},qo=s(()=>t("h3",{class:"text-lg font-bold text-gray-700 mb-3"},"Weekly Credit & Debit",-1)),Po={class:"overflow-y-auto max-h-96"},Ho={class:"min-w-full table-auto text-sm text-left text-gray-600"},Go=s(()=>t("thead",{class:"bg-gray-100 font-medium text-gray-700"},[t("tr",null,[t("th",{class:"px-2 py-2"},"Week"),t("th",{class:"px-2 py-2"},"Total Credit"),t("th",{class:"px-2 py-2"},"Total Debit")])],-1)),zo={class:"px-2 py-2"},Fo={class:"px-2 py-2"},Ko={class:"px-2 py-2"},Jo={class:"font-semibold text-gray-800 bg-gray-50 border-t"},Xo=s(()=>t("td",{class:"px-2 py-2"},"Total",-1)),Qo={class:"px-2 text-green-800 py-2"},Zo={class:"px-2 text-red-800 py-2"},tn={class:"grid grid-cols-1 md:grid-cols-2 gap-6 text-sm"},en={class:"bg-white p-6 rounded-2xl shadow-md"},sn=s(()=>t("h2",{class:"text-lg font-semibold text-blue-700 mb-4"},"Loan Analysis",-1)),on={class:"space-y-2"},nn={class:"flex justify-between"},an=s(()=>t("span",null,"Number of Loan Transactions",-1)),ln={class:"flex justify-between"},dn=s(()=>t("span",null,"Total Loan Amount",-1)),cn={class:"flex justify-between"},rn=s(()=>t("span",null,"Average Monthly Loan Amount",-1)),un={class:"flex justify-between"},_n=s(()=>t("span",null,"Total Loan Repayment Amount",-1)),mn={class:"flex justify-between"},fn=s(()=>t("span",null,"Average Monthly Loan Repayment Amount",-1)),pn={class:"flex justify-between"},hn=s(()=>t("span",null,"Loan to Inflow Rate",-1)),vn={class:"flex justify-between"},yn=s(()=>t("span",null,"Latest Loan Transaction Date",-1)),xn={class:"flex justify-between"},bn=s(()=>t("span",null,"Latest Loan Repayment Transaction Date",-1)),gn={class:"bg-white p-6 rounded-2xl shadow-md"},wn=s(()=>t("h2",{class:"text-lg font-semibold text-blue-700 mb-4"},"Patterns",-1)),Mn={class:"space-y-2"},Tn={class:"flex justify-between"},An=s(()=>t("span",null,"Account Sweep",-1)),kn={class:"flex justify-between"},On=s(()=>t("span",null,"Number of Betting Transactions",-1)),Yn={class:"flex justify-between"},Sn=s(()=>t("span",null,"Gambling Rate",-1)),Rn={class:"flex justify-between"},Dn=s(()=>t("span",null,"Percentage of Debit Transactions",-1)),In={class:"flex justify-between"},jn=s(()=>t("span",null,"Percentage of Credit Transactions",-1)),Nn={class:"flex justify-between"},En=s(()=>t("span",null,"Percentage of Transactions between 500k - 1M",-1)),Ln={class:"flex justify-between"},Cn=s(()=>t("span",null,"Percentage of Transactions Greater Than 1M",-1)),$n={class:"flex justify-between"},Bn=s(()=>t("span",null,"Most Frequent Balance Range",-1)),Vn={class:"flex flex-wrap gap-4 justify-between mt-4"},Un={class:"bg-[#2059a5] text-white p-6 rounded-2xl w-full md:w-[48%] shadow"},Wn={class:"grid grid-cols-3 gap-4 text-sm md:text-base"},qn=s(()=>t("div",null,null,-1)),Pn=s(()=>t("div",{class:"text-center font-medium"},"Outflow",-1)),Hn=s(()=>t("div",{class:"text-center font-medium"},"Inflow",-1)),Gn=s(()=>t("div",{class:"text-left"},"Number of Self Transfers",-1)),zn={class:"text-center font-semibold"},Fn={class:"text-center font-semibold"},Kn=s(()=>t("div",{class:"text-left"},"Value of Self Transfers",-1)),Jn={class:"text-center font-semibold"},Xn={class:"text-center font-semibold"},Qn={class:"bg-[#2059a5] text-white p-6 rounded-2xl w-full md:w-[48%] shadow"},Zn={class:"grid grid-cols-2 gap-4 text-center"},ta={class:"text-2xl font-bold"},ea=s(()=>t("div",{class:"text-sm"},"Total Transactions",-1)),sa={class:"text-2xl font-bold"},oa=s(()=>t("div",{class:"text-sm"},"Returned Cheque",-1)),na={class:"flex flex-col md:flex-row gap-6 justify-between mt-4"},aa={class:"w-full md:w-1/2"},la=s(()=>t("h3",{class:"font-semibold text-sm md:text-base mb-2"}," Self Transfer Transactions ",-1)),da={class:"bg-white rounded-xl border shadow p-4 max-h-96 overflow-y-auto"},ia={class:"w-full text-sm text-left"},ca=s(()=>t("thead",{class:"text-gray-600"},[t("tr",null,[t("th",{class:"py-2 px-4"},"Month"),t("th",{class:"py-2 px-4"},"Inflow"),t("th",{class:"py-2 px-4"},"Outflow")])],-1)),ra={key:0},ua=s(()=>t("td",{colspan:"3",class:"text-center py-4 text-gray-500"}," No data available ",-1)),_a=[ua],ma={class:"py-2 px-4"},fa={class:"py-2 px-4"},pa={class:"py-2 px-4"},ha={class:"w-full md:w-1/2"},va=s(()=>t("h3",{class:"font-semibold text-sm md:text-base mb-2"}," Account Balance Analysis ",-1)),ya={class:"bg-white border rounded-xl shadow p-4 max-h-96 overflow-y-auto"},xa={class:"w-full text-sm text-left"},ba=s(()=>t("thead",{class:"text-gray-600"},[t("tr",null,[t("th",{class:"py-2 px-4"},"Month"),t("th",{class:"py-2 px-4"},"Highest Balance"),t("th",{class:"py-2 px-4"},"Lowest Balance")])],-1)),ga={class:"py-2 px-4"},wa={class:"py-2 px-4"},Ma={class:"py-2 px-4"},Ta={class:"py-4"},Aa=s(()=>t("span",{class:"text-2xl font-semibold"},"Transaction History",-1)),ka=s(()=>t("i",{class:"fas fa-filter text-black-600 text-lg"},null,-1)),Oa=s(()=>t("thead",{class:"font-semibold text-gray-600"},[t("tr",null,[t("th",{class:"px-2 py-3 font-semibold"},"S/N"),t("th",{class:"px-2 py-3 font-semibold"},"Date"),t("th",{class:"px-2 py-3 font-semibold"},"Description"),t("th",{class:"px-2 py-3 font-semibold"},"Type"),t("th",{class:"px-2 py-3 font-semibold"},"Amount"),t("th",{class:"px-2 py-3 font-semibold"},"Balance")])],-1)),Ya={class:"px-2 py-4"},Sa={class:"px-2 py-4"},Ra={class:"px-2 py-4"},Da={class:"px-2 py-4"},Ia={class:"px-2 py-4"},ja=s(()=>t("span",null,"1–12 of 12",-1)),Na={class:"flex items-center space-x-2"},Ea=s(()=>t("span",null,"Rows per page:",-1)),La={class:"flex justify-between items-center mb-4"},Ca=s(()=>t("h2",{class:"text-lg font-semibold"},"Filter Transactions",-1)),$a=s(()=>t("i",{class:"fas fa-sign-out-alt"},null,-1)),Ba=[$a],Va={class:"space-y-4"},Ua=s(()=>t("label",{class:"text-sm font-medium"},"Date",-1)),Wa={class:"flex gap-2 mt-1"},qa=s(()=>t("label",{class:"text-sm font-medium"},"Type",-1)),Pa={class:"flex gap-2"},Ha={class:"flex justify-end gap-2 mt-4"},Ga={__name:"StatementAnalysis",setup(G){const et=n("Summary"),z=c=>k(c).format("MMMM Do YYYY,");function i(c){return new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN",minimumFractionDigits:2}).format(c||0)}const st=n(15),V=$e(),b=Be(),_t=n(null),C=n(!0),u=n(null),m=n(""),S=n(""),f=n(""),w=n(""),mt=n(0),ot=n(0),q=n(0),F=n(0),P=n(0),U=n(0),kt=n(0),ue=n(0),Ot=n(0),Yt=n(0),_e=n(0),St=n(0),ft=n([]),pt=n([]),me=Q(()=>ft.value.reduce((c,a)=>c+a.credit,0)),fe=Q(()=>ft.value.reduce((c,a)=>c+a.debit,0)),pe=Q(()=>pt.value.reduce((c,a)=>c+a.credit,0)),he=Q(()=>pt.value.reduce((c,a)=>c+a.debit,0)),Rt=n(0),Dt=n(0),It=n(0),jt=n(""),Nt=n([]),Et=n(""),Lt=n(""),Ct=n(""),$t=n(""),Bt=n(0),bt=n(""),Vt=n(0),Ut=n(""),ve=n(0),ye=n(0),Wt=n(0),qt=n(0),Pt=n(0),Ht=n(0),Gt=n(0),xe=n(0),be=n(0),zt=n(""),Ft=n([]),Kt=n(""),ge=n(""),we=n(0),Me=n(""),Jt=n(0),Xt=n(0),Qt=n(0),Zt=n(0),te=n(0),ee=n(0),se=n(0),ht=n([]),oe=n([]),gt=n([]),wt=n([]),Te=async c=>{var A,D,E,L,I,H,K,J,X,vt,W,at,lt;const a=JSON.parse(localStorage.getItem("data")||"{}"),N=(a==null?void 0:a.token)||b.token,T=`https://dev02201.getjupita.com/api/${((A=a==null?void 0:a.user)==null?void 0:A.tenant_id)||b.tenant_id}/get-analysis-result?analysis_id=${c}`;C.value=!0;try{let ae=function(d){return k(d,"M-YYYY").format("MMM YYYY")};const B=await xt.get(T,{headers:{Authorization:`Bearer ${N}`,"Content-Type":"application/json"}});console.log("statement analysis result page data:",B),_t.value=B.data;const e=(L=(E=(D=B.data)==null?void 0:D.data)==null?void 0:E.analysis_result)==null?void 0:L.analysis_result;m.value=(e==null?void 0:e.name)||"N/A",S.value=(e==null?void 0:e.clientFullName)||"N/A",w.value=(e==null?void 0:e.accountId)||"N/A";const _=(e==null?void 0:e.behavioralAnalysis)||{};bt.value=_.accountSweep||"No",Vt.value=_.gamblingRate||0,Ut.value=_.gamblingStatus||"N/A",ve.value=_.loanInflowRate||0,ye.value=_.accountActivity||0,Wt.value=_.totalLoanAmount||0,qt.value=_.loanToInflowRate||0,Pt.value=_.numberLoanTransactions||0,Ht.value=_.averageMonthlyLoanAmount||0,Gt.value=_.totalLoanRepaymentAmount||0,xe.value=_.loanRepaymentToInflowRate||0,be.value=_.numberRepaymentTransactions||0,Ft.value=_.latestRepaymentTransaction||[];const yt=Ft.value[0]||null;Kt.value=yt!=null&&yt.date?k(yt.date).format("MMM D, YYYY"):"N/A";const ne=(I=_.latestLoanTransaction)==null?void 0:I[0];zt.value=ne?k(ne.date).format("MMMM D, YYYY"):"N/A",ge.value=_.overallInflowToOutflowRate||"N/A",we.value=_.percentOfInflowIrregularity||0,Me.value=_.monthToMonthInflowToOutflowRate||"N/A",Jt.value=_.averageMonthlyLoanRepaymentAmount||0;const l=e==null?void 0:e.cashFlowAnalysis;console.log("cash flow data:",l),Rt.value=e==null?void 0:e.spendAnalysis.mostFrequentExpense,Dt.value=e==null?void 0:e.spendAnalysis.mostFrequentExpenseAmount;const x=((X=(J=(K=(H=B.data)==null?void 0:H.data)==null?void 0:K.analysis_result)==null?void 0:J.analysis_result)==null?void 0:X.spendAnalysis)||{},Y=((lt=(at=(W=(vt=B.data)==null?void 0:vt.data)==null?void 0:W.analysis_result)==null?void 0:at.analysis_result)==null?void 0:lt.transactionPatternAnalysis)||{};console.log("pattern analysis:",Y),Et.value=(Y.percentDebitTransactions*100).toFixed(2)+"%",Lt.value=(Y.percentDebitTransactions*100).toFixed(2)+"%",Ct.value=(Y.percentOfTransactionsBetween500ThousandToOneMillionNaira*100).toFixed(2)+"%",$t.value=(Y.percentOfTransactionsGreaterThanOneMillionNaira*100).toFixed(2)+"%",Bt.value=Y.mostFrequentBalanceRange,Xt.value=Y.noOfSelfTransferInflows,Qt.value=Y.noOfSelfTransferOutflows,Zt.value=Y.selfTransferInflowAmount,te.value=Y.selfTransferOutflowAmount,ee.value=Y.totalNumberOfTransactions,se.value=Y.returnCheque;const Se=Y.selfTransferInflowTransactionsByMonth||[],Re=Y.selfTransferOutflowTransactionsByMonth||[],dt=new Map;Se.forEach(d=>{const h=ae(d.date);dt.set(h,{month:h,inflow:d.amount,outflow:0})}),Re.forEach(d=>{const h=ae(d.date);dt.has(h)?dt.get(h).outflow=d.amount:dt.set(h,{month:h,inflow:0,outflow:d.amount})}),ht.value=Array.from(dt.values()).sort((d,h)=>k(d.month,"MMM YYYY")-k(h.month,"MMM YYYY")),It.value=x.highestSpend,jt.value=k(x.monthWithHighestSpend,"M/YYYY").format("MMMM YYYY"),Nt.value=[{label:"Others",monthly:x.averageMonthlySpendOnOthers??0,total:12*(x.averageMonthlySpendOnOthers??0)},{label:"Rent",monthly:x.averageMonthlySpendOnRent??0,total:12*(x.averageMonthlySpendOnRent??0)},{label:"Hospitality and Food",monthly:x.averageMonthlySpendOnHospitalityAndFood??0,total:12*(x.averageMonthlySpendOnHospitalityAndFood??0)},{label:"Transportation",monthly:x.averageMonthlySpendOnTransportation??0,total:12*(x.averageMonthlySpendOnTransportation??0)},{label:"Utilities",monthly:x.averageMonthlySpendOnUtilities??0,total:12*(x.averageMonthlySpendOnUtilities??0)},{label:"Charges and Stamp Duty",monthly:x.averageMonthlySpendOnChargesAndStampDuty??0,total:12*(x.averageMonthlySpendOnChargesAndStampDuty??0)},{label:"Transfer",monthly:x.averageMonthlySpendOnTransfer??0,total:12*(x.averageMonthlySpendOnTransfer??0)},{label:"ATM Withdrawals and POS",monthly:x.averageMonthlySpendOnAtmAndPOS??0,total:12*(x.averageMonthlySpendOnAtmAndPOS??0)}],mt.value=(l==null?void 0:l.totalDebitTurnOver)||0,ot.value=(l==null?void 0:l.totalCreditTurnover)||0,q.value=(l==null?void 0:l.averageMonthlyDebits)||0,F.value=(l==null?void 0:l.averageMonthlyCredits)||0,P.value=(l==null?void 0:l.averageMonthlyBalance)||0,U.value=(l==null?void 0:l.averageWeeklyBalance)||0,kt.value=(l==null?void 0:l.totalCreditTurnover)||0,ue.value=(l==null?void 0:l.averageMonthlyCredits)||0,Ot.value=(l==null?void 0:l.averageWeeklyCredits)||0,Yt.value=(l==null?void 0:l.totalDebitTurnOver)||0,_e.value=(l==null?void 0:l.averageMonthlyDebits)||0,St.value=(l==null?void 0:l.averageWeeklyDebits)||0;const De=(l==null?void 0:l.monthlyHighestBalance)||[],Ie=(l==null?void 0:l.monthlyLowestBalance)||[],it=new Map;De.forEach(d=>{const h=`${d.month_name} ${d.year}`,R=k(h,"MMMM YYYY").format("MMM YYYY"),j=`${d.month_name}-${d.year}`;it.set(j,{month:R,highest:d.highest_balance,lowest:0})}),Ie.forEach(d=>{const h=`${d.month_name} ${d.year}`,R=k(h,"MMMM YYYY").format("MMM YYYY"),j=`${d.month_name}-${d.year}`;it.has(j)?it.get(j).lowest=d.lowest_balance:it.set(j,{month:R,highest:0,lowest:d.lowest_balance})}),oe.value=Array.from(it.values());const je=(l==null?void 0:l.monthlyInflow)||[],Ne=(l==null?void 0:l.monthlyOutflow)||[],ct=new Map;je.forEach(d=>{const h=`${d.month_name} ${d.year}`,R=k(h,"MMMM YYYY").format("MMM YYYY"),j=`${d.month_name}-${d.year}`;ct.set(j,{month:R,credit:d.amount,debit:0})}),Ne.forEach(d=>{const h=`${d.month_name} ${d.year}`,R=k(h,"MMMM YYYY").format("MMM YYYY"),j=`${d.month_name}-${d.year}`;ct.has(j)?ct.get(j).debit=d.amount:ct.set(j,{month:R,credit:0,debit:d.amount})}),ft.value=Array.from(ct.values());const Ee=(l==null?void 0:l.weeklyInflow)||[],Le=(l==null?void 0:l.weeklyOutflow)||[],rt=new Map;Ee.forEach(d=>{const h=k().month(d.month_name).format("MMM"),R=`${d.year}-${h}-W${d.week}`;rt.set(R,{week:`${h} ${d.year} | ${d.week}`,credit:d.amount,debit:0})}),Le.forEach(d=>{const h=k().month(d.month_name).format("MMM"),R=`${d.year}-${h}-W${d.week}`;rt.has(R)?rt.get(R).debit=d.amount:rt.set(R,{week:`${h} ${d.year} ${d.week}`,credit:0,debit:d.amount})}),pt.value=Array.from(rt.values());const le=new Date(e==null?void 0:e.startDate),de=new Date(e==null?void 0:e.endDate);!isNaN(le)&&!isNaN(de)?f.value=`${k(le).format("MMMM D, YYYY")} - ${k(de).format("MMMM D, YYYY")}`:f.value="Unknown period"}catch(B){console.error("Error fetching analysis result:",B),u.value="Unable to fetch analysis result."}finally{C.value=!1}},Ae=async()=>{var A;const c=JSON.parse(localStorage.getItem("data")||"{}"),a=(c==null?void 0:c.token)||b.token,N=((A=c==null?void 0:c.user)==null?void 0:A.tenant_id)||b.tenant_id,$=V.params.id,T=`https://dev02201.getjupita.com/api/${N}/get-statement-transactions?analysis_id=${$}`;try{const D=await xt.get(T,{headers:{Authorization:`Bearer ${a}`}});console.log("fetch transactions response:",D),wt.value=D.data.data.transactions,gt.value=[...wt.value]}catch(D){console.error(D)}},Mt=n(!1),Tt=n(!1),v=Ve({dateRange:[null,null]});Q(()=>z(v.dateRange[0])),Q(()=>z(v.dateRange[1]));const nt=n(!1),ke=()=>{v.value={dateFrom:"",dateTo:"",description:"",type:"All",amountMin:"",amountMax:""}},Oe=()=>{gt.value=wt.value.filter(c=>{const a=!v.description||c.description.toLowerCase().includes(v.description.toLowerCase()),N=new Date(c.date),$=v.dateRange[0]?new Date(v.dateRange[0]):null,T=v.dateRange[1]?new Date(v.dateRange[1]):null,A=(!$||N>=$)&&(!T||N<=T);return a&&A}),nt.value=!1};Ue(()=>{Ae();const c=V.params.id;c?Te(c):(u.value="Invalid analysis ID.",C.value=!1)});const Ye=async()=>{var A,D,E;const c=JSON.parse(localStorage.getItem("data")||"{}"),a=(c==null?void 0:c.token)||b.token,N=((A=c==null?void 0:c.user)==null?void 0:A.tenant_id)||b.tenant_id,$=V.params.id,T=`https://dev02201.getjupita.com/api/${N}/download-insight-report?analysis_id=${$}`;try{At({title:"Downloading",message:"Getting your analysis report...",type:"info",duration:3e3});const L=await xt.get(T,{headers:{Authorization:`Bearer ${a}`}}),I=(E=(D=L==null?void 0:L.data)==null?void 0:D.data)==null?void 0:E.download;if(!(I!=null&&I.document_url)||!(I!=null&&I.document_name))throw new Error("No download information or document URL found in the response.");const H=I.document_url,J="analysis_report.pdf",X=await xt.get(H,{responseType:"blob"});ze.saveAs(X.data,J),At({title:"Success",message:"Analysis report downloaded successfully.",type:"success",duration:6e3})}catch(L){console.error("Download failed:",L),At({title:"Error",message:"Failed to download analysis. Please try again.",type:"error",duration:6e3})}};return(c,a)=>{const N=g("v-progress-circular"),$=g("RouterLink"),T=g("v-btn"),A=g("v-tab"),D=g("v-tabs"),E=g("v-tabs-window-item"),L=g("v-card-title"),I=g("v-table"),H=g("v-select"),K=g("v-icon"),J=g("v-card-actions"),X=g("v-card"),vt=g("v-tabs-window"),W=g("v-text-field"),at=g("v-date-picker"),lt=g("v-menu"),B=g("v-navigation-drawer");return M(),We(qe,null,{default:p(()=>[t("div",Fe,[Ke,C.value?(M(),O("div",Je,[r(N,{size:100,width:10,color:"primary",indeterminate:""})])):(M(),O("div",Xe,[t("div",Qe,[r($,{to:"/dashboard"},{default:p(()=>[t("button",{onClick:a[0]||(a[0]=(...e)=>c.goBack&&c.goBack(...e)),class:"mb-2 flex items-center text-blue-600 font-semibold"},[Ze,y(" Back ")])]),_:1}),t("div",ts,[r(T,{onClick:Ye,"no-uppercase":"",size:"small",class:"normal-case p-4 bg-blue-600 hover:bg-blue-700 text-white text-none mr-2 custom-btn"},{default:p(()=>[es,y(" Download Analysis ")]),_:1})])]),t("div",ss,[t("p",null,[os,ns,y(),as,y(" "+o(f.value),1)]),t("p",null,[ls,ds,y(),is,y(" "+o(S.value),1)]),t("p",null,[cs,rs,y(),us,y(" "+o(w.value),1)])]),t("div",_s,[r(D,{"align-tabs":"center",class:"mb-6",modelValue:et.value,"onUpdate:modelValue":a[1]||(a[1]=e=>et.value=e),color:"primary"},{default:p(()=>[r(A,{value:"summary"},{default:p(()=>[y("Summary")]),_:1}),r(A,{value:"cash flow"},{default:p(()=>[y("Cash Flow")]),_:1}),r(A,{value:"behavioral"},{default:p(()=>[y("Behavioral")]),_:1}),r(A,{value:"transactions"},{default:p(()=>[y("Transactions")]),_:1})]),_:1},8,["modelValue"]),r(vt,{modelValue:et.value,"onUpdate:modelValue":a[4]||(a[4]=e=>et.value=e)},{default:p(()=>[r(E,{value:"summary"},{default:p(()=>[t("div",ms,[t("div",fs,[t("div",ps,o(i(ot.value)),1),hs]),t("div",vs,[t("div",ys,o(i(mt.value)),1),xs]),t("div",bs,[t("div",gs,o(i(F.value)),1),ws]),t("div",Ms,[t("div",Ts,o(i(q.value)),1),As]),t("div",ks,[t("div",Os,o(i(P.value)),1),Ys])]),t("div",Ss,[t("div",Rs,[Ds,t("p",Is,[y(o(Rt.value),1),js])]),t("div",Ns,[Es,t("p",Ls,o(i(It.value)),1),t("p",Cs," Transaction Date: "+o(jt.value),1)]),t("div",$s,[Bs,t("p",Vs,o(i(Dt.value)),1)])]),t("div",Us,[Ws,t("table",qs,[Ps,t("tbody",null,[(M(!0),O(Z,null,tt(Nt.value,(e,_)=>(M(),O("tr",{key:_,class:"text-sm text-gray-700 border-b border-gray-100 hover:bg-gray-50"},[t("td",Hs,o(e.label),1),t("td",Gs,o(i(e.monthly)),1),t("td",zs,o(i(e.total)),1)]))),128))])])])]),_:1}),r(E,{value:"cash flow"},{default:p(()=>[t("div",Fs,[t("div",Ks,[Js,t("div",Xs,[t("div",Qs,[Zs,t("span",to,o(i(kt.value)),1)]),t("div",eo,[so,t("span",oo,o(i(F.value)),1)]),t("div",no,[ao,t("span",lo,o(i(Ot.value)),1)])])]),t("div",io,[co,t("div",ro,[t("div",uo,[_o,t("span",mo,o(i(Yt.value)),1)]),t("div",fo,[po,t("span",ho,o(i(q.value)),1)]),t("div",vo,[yo,t("span",xo,o(i(St.value)),1)])])])]),t("div",bo,[t("div",go,[t("div",wo,[y(o(i(P.value))+" ",1),Mo]),t("div",To,[y(o(i(U.value))+" ",1),Ao])]),ko]),t("div",Oo,[Yo,t("div",So,[t("div",Ro,[Do,t("div",Io,[t("table",jo,[No,t("tbody",null,[(M(!0),O(Z,null,tt(ft.value,(e,_)=>(M(),O("tr",{key:_,class:"border-b"},[t("td",Eo,o(e.month),1),t("td",Lo,o(i(e.credit)),1),t("td",Co,o(i(e.debit)),1)]))),128))]),t("tfoot",$o,[t("tr",null,[Bo,t("td",Vo,o(i(me.value)),1),t("td",Uo,o(i(fe.value)),1)])])])])]),t("div",Wo,[qo,t("div",Po,[t("table",Ho,[Go,t("tbody",null,[(M(!0),O(Z,null,tt(pt.value,(e,_)=>(M(),O("tr",{key:_,class:"border-b"},[t("td",zo,o(e.week),1),t("td",Fo,o(i(e.credit)),1),t("td",Ko,o(i(e.debit)),1)]))),128))]),t("tfoot",Jo,[t("tr",null,[Xo,t("td",Qo,o(i(pe.value)),1),t("td",Zo,o(i(he.value)),1)])])])])])])])]),_:1}),r(E,{value:"behavioral"},{default:p(()=>[t("div",tn,[t("div",en,[sn,t("div",on,[t("div",nn,[an,t("span",null,o(Pt.value),1)]),t("div",ln,[dn,t("span",null,o(i(Wt.value)),1)]),t("div",cn,[rn,t("span",null,o(i(Ht.value)),1)]),t("div",un,[_n,t("span",null,o(i(Gt.value)),1)]),t("div",mn,[fn,t("span",null,o(i(Jt.value)),1)]),t("div",pn,[hn,t("span",null,o(qt.value)+"%",1)]),t("div",vn,[yn,t("span",null,o(zt.value),1)]),t("div",xn,[bn,t("span",null,o(Kt.value),1)])])]),t("div",gn,[wn,t("div",Mn,[t("div",Tn,[An,t("span",{class:ie(["font-semibold",bt.value==="YES"?"text-green-600":"text-gray-600"])},o(bt.value),3)]),t("div",kn,[On,t("span",null,o(Ut.value),1)]),t("div",Yn,[Sn,t("span",null,o(Vt.value),1)]),t("div",Rn,[Dn,t("span",null,o(Et.value),1)]),t("div",In,[jn,t("span",null,o(Lt.value),1)]),t("div",Nn,[En,t("span",null,o(Ct.value),1)]),t("div",Ln,[Cn,t("span",null,o($t.value),1)]),t("div",$n,[Bn,t("span",null,o(Bt.value),1)])])])]),t("div",Vn,[t("div",Un,[t("div",Wn,[qn,Pn,Hn,Gn,t("div",zn,o(Qt.value),1),t("div",Fn,o(Xt.value),1),Kn,t("div",Jn,o(i(te.value)),1),t("div",Xn,o(i(Zt.value)),1)])]),t("div",Qn,[t("div",Zn,[t("div",null,[t("div",ta,o(ee.value),1),ea]),t("div",null,[t("div",sa,o(se.value),1),oa])])])]),t("div",na,[t("div",aa,[la,t("div",da,[t("table",ia,[ca,t("tbody",null,[!ht.value||ht.value.length===0?(M(),O("tr",ra,_a)):Pe("",!0),(M(!0),O(Z,null,tt(ht.value,(e,_)=>(M(),O("tr",{key:_,class:"border-b last:border-none"},[t("td",ma,o(e.month),1),t("td",fa,o(i(e.inflow)),1),t("td",pa,o(i(e.outflow)),1)]))),128))])])])]),t("div",ha,[va,t("div",ya,[t("table",xa,[ba,t("tbody",null,[(M(!0),O(Z,null,tt(oe.value,(e,_)=>(M(),O("tr",{key:_},[t("td",ga,o(e.month),1),t("td",wa,o(i(e.highest)),1),t("td",Ma,o(i(e.lowest)),1)]))),128))])])])])])]),_:1}),r(E,{value:"transactions"},{default:p(()=>[t("div",Ta,[r(X,{class:"rounded-lg shadow-md"},{default:p(()=>[r(L,{class:"d-flex justify-between items-center px-6 py-4"},{default:p(()=>[Aa,r(T,{onClick:a[2]||(a[2]=e=>nt.value=!0),icon:"",variant:"text"},{default:p(()=>[ka]),_:1})]),_:1}),r(I,{class:"min-w-full text-sm pa-4"},{default:p(()=>[Oa,t("tbody",null,[(M(!0),O(Z,null,tt(gt.value,(e,_)=>(M(),O("tr",{key:_,class:"border-t border-gray-200 hover:bg-gray-50 transition-colors"},[t("td",Ya,o(_+1),1),t("td",Sa,o(z(e.date)),1),t("td",Ra,o(e.description),1),t("td",{class:ie(["px-6 py-4 font-semibold",e.type==="CREDIT"?"text-green-600":"text-red-600"])},o(e.type),3),t("td",Da,o(i(e.amount)),1),t("td",Ia,o(i(e.balance)),1)]))),128))])]),_:1}),r(J,{class:"justify-between px-6 py-4 text-sm text-gray-500"},{default:p(()=>[ja,t("div",Na,[Ea,r(H,{items:[15,30,45],modelValue:st.value,"onUpdate:modelValue":a[3]||(a[3]=e=>st.value=e),density:"compact","hide-details":"",class:"w-20",variant:"outlined"},null,8,["modelValue"]),r(T,{icon:"",density:"comfortable"},{default:p(()=>[r(K,null,{default:p(()=>[y("mdi-chevron-left")]),_:1})]),_:1}),r(T,{icon:"",density:"comfortable"},{default:p(()=>[r(K,null,{default:p(()=>[y("mdi-chevron-right")]),_:1})]),_:1})])]),_:1})]),_:1})])]),_:1})]),_:1},8,["modelValue"])]),r(B,{modelValue:nt.value,"onUpdate:modelValue":a[16]||(a[16]=e=>nt.value=e),location:"right",temporary:"",width:"500",class:"px-4 pt-6"},{default:p(()=>[t("div",La,[Ca,t("div",{icon:"",onClick:a[5]||(a[5]=e=>nt.value=!1)},Ba)]),t("div",Va,[t("div",null,[Ua,t("div",Wa,[r(lt,{modelValue:Mt.value,"onUpdate:modelValue":a[8]||(a[8]=e=>Mt.value=e),"close-on-content-click":!1,transition:"scale-transition","offset-y":""},{activator:p(({props:e})=>[r(W,ce({label:"From",readonly:""},e,{density:"compact",variant:"outlined","prepend-inner-icon":"mdi-calendar"}),null,16)]),default:p(()=>[r(at,{class:"vdp-small",modelValue:v.dateRange[0],"onUpdate:modelValue":[a[6]||(a[6]=e=>v.dateRange[0]=e),a[7]||(a[7]=e=>Mt.value=!1)]},null,8,["modelValue"])]),_:1},8,["modelValue"]),r(lt,{modelValue:Tt.value,"onUpdate:modelValue":a[11]||(a[11]=e=>Tt.value=e),"close-on-content-click":!1,transition:"scale-transition","offset-y":""},{activator:p(({props:e})=>[r(W,ce({label:"To",readonly:""},e,{density:"compact",variant:"outlined","prepend-inner-icon":"mdi-calendar"}),null,16)]),default:p(()=>[r(at,{modelValue:v.dateRange[1],"onUpdate:modelValue":[a[9]||(a[9]=e=>v.dateRange[1]=e),a[10]||(a[10]=e=>Tt.value=!1)]},null,8,["modelValue"])]),_:1},8,["modelValue"])])]),t("div",null,[r(W,{color:"blue",label:"Description",modelValue:v.description,"onUpdate:modelValue":a[12]||(a[12]=e=>v.description=e),density:"compact",variant:"outlined",placeholder:"Enter description"},null,8,["modelValue"])]),t("div",null,[qa,r(H,{color:"blue",modelValue:v.type,"onUpdate:modelValue":a[13]||(a[13]=e=>v.type=e),items:["CREDIT","DEBIT"],density:"compact",variant:"outlined",placeholder:"Select type"},null,8,["modelValue"])]),t("div",Pa,[r(W,{color:"blue",modelValue:v.minAmount,"onUpdate:modelValue":a[14]||(a[14]=e=>v.minAmount=e),label:"Min Amount",density:"compact",variant:"outlined",type:"number"},null,8,["modelValue"]),r(W,{color:"blue",modelValue:v.maxAmount,"onUpdate:modelValue":a[15]||(a[15]=e=>v.maxAmount=e),label:"Max Amount",density:"compact",variant:"outlined",type:"number"},null,8,["modelValue"])]),t("div",Ha,[r(T,{onClick:Oe,variant:"tonal",color:"primary"},{default:p(()=>[y("Apply")]),_:1}),r(T,{onClick:ke,variant:"text",color:"grey"},{default:p(()=>[y("Reset")]),_:1})])])]),_:1},8,["modelValue"])]))])]),_:1})}}},Fa=Ce(Ga,[["__scopeId","data-v-03ca651f"]]);export{Fa as default};
